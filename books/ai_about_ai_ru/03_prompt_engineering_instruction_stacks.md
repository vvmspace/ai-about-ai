# Стек инструкций, который не разваливается

Большинство провалов промптов происходит не из-за длины текста.
Провал — из-за архитектуры.

Требования смешаны со стилем.
Жёсткие ограничения утонули между «пожеланиями».
Формат выхода подразумевается, но не задан.

А потом звучит знакомое: «Модель игнорирует инструкции».

Обычно она ничего не игнорирует.
Она получает запутанную иерархию и выбирает то, что статистически более совместимо.

## Думайте как архитектор, а не как копирайтер

В профессиональном контуре промптинг — это архитектура решений.

Нужен стек, который держится даже на грязных входных данных.

Рабочий порядок слоёв:

1. **Роль и цель** — какую задачу выполняет модель.
2. **Жёсткие ограничения** — legal/compliance/technical рамки.
3. **Требования к процессу** — как организовать рассуждение.
4. **Контракт выхода** — строгая структура результата.
5. **Стилистика** — тон, голос, форматирование.

Если стиль выше ограничений — риск резко растёт.

## System prompt vs user prompt: практический разбор

Когда ищут «system prompt и user prompt», обычно спрашивают: что куда класть?

Простой принцип:

- **System level**: стабильные правила и неизменные политики.
- **User level**: переменные детали конкретной задачи.

Так вы снижаете случайные перезаписи и получаете устойчивость на масштабе.

## Одна строка, которая экономит деньги

Явно добавьте поведение при конфликте:

> Если ограничения конфликтуют или не хватает обязательных данных, остановись, опиши конфликт и запроси уточнение.

Без этого модель часто имитирует уверенность, потому что «хочет быть полезной».

Полезность без рамок — вежливый путь к ошибке.

## Хрупкий стек vs устойчивый стек

### Хрупкий
«Будь аналитиком, пиши кратко, но полно, включай все риски, не перегружай деталями, соблюдай комплаенс, говори дружелюбно».

Внутри сразу конфликты.

### Устойчивый
- Цель: executive risk summary для руководства.
- Must: 3 ключевых риска с evidence.
- Must not: юридические советы и свободная интерпретация политики.
- Process: оценка по impact/likelihood.
- Output: 5 bullets + 1 блок рекомендаций.
- Style: просто, без жаргона.

Намерение одно и то же. Надёжность — другая.

## Антипаттерны

### 1) Instruction soup
Всё в один абзац без приоритетов.

### 2) Скрытые ограничения
Критичные правила спрятаны в «литературном тексте».

### 3) Мягкий язык для жёстких правил
«Постарайся» там, где нужно «обязан».

### 4) Нет контракта выхода
А потом удивление, почему формат «плавает».

## Быстрый чеклист перед запуском

- Ограничения явно выделены и ранжированы?
- Коллега поймёт стек за 90 секунд?
- Формат выхода однозначный?
- Поведение при конфликте задано?
- Критерии pass/fail проверяемы?

Если хотя бы одно «нет» — в прод не выпускаем.

## Практика: перестройка боевого промпта

Возьмите один текущий промпт.

1. Разбейте на 5 слоёв.
2. Проставьте Must / Should / Optional.
3. Добавьте линию про конфликт требований.
4. Зафиксируйте строгий output contract.
5. Протестируйте на 15 грязных кейсах.

Скрытые противоречия обычно всплывают в первые 10 минут.

## Почему это важно шире, чем prompt engineering

Качество стека отражает качество мышления в компании.
Если инструкции мутные — решения тоже мутные.
Если приоритеты неясны в промпте — они неясны и в совещаниях.

Чистый стек тренирует чистую командную работу.

В 2026 ясность — это не «красивый текст».
Это скорость исполнения.

Фраза на память:

**Промпт без иерархии — это политика без управления.**
