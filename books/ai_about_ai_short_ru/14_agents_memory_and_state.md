# Память, состояние и длинные задачи

Длинные агентные задачи ломаются чаще из-за плохого управления состоянием, чем из-за «слабой модели».
Если память не спроектирована, агент теряет контекст, дублирует действия и создаёт шум.

## Память — это инфраструктура

Для устойчивой работы нужно заранее определить:

- что сохранять,
- где сохранять,
- когда обновлять,
- что архивировать или забывать.

Без этого длинный workflow деградирует с каждой итерацией.

## Практичная 3-уровневая модель

1. **Рабочая память** — текущий шаг и ближайшие решения.
2. **Сессионная память** — прогресс задачи и ключевые события.
3. **Долгая память** — устойчивые правила, предпочтения, исторические паттерны.

Разные уровни — разные TTL и правила обновления.

## Состояние должно быть структурировано

Используйте схему вместо свободных заметок:

- objective,
- stage,
- done/not-done,
- blockers,
- next action,
- confidence.

Структура повышает воспроизводимость и дебажимость.

## Антипаттерны

- хранить всё в одном «бесконечном логе»;
- не делать checkpoint на длинных этапах;
- смешивать факты и гипотезы без маркировки;
- не удалять устаревший контекст.

Итог главы:

**Надёжная память делает агента предсказуемым: состояние должно быть явным, многоуровневым и регулярно очищаемым.**

---

[Память и состояние AI-агентов](../ai_about_ai_ru/14_agents_memory_and_state.md) | [Memory and State](../ai_about_ai_short/14_agents_memory_and_state.md) |
