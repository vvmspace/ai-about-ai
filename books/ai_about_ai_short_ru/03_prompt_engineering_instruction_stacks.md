# Стек инструкций, который не разваливается

Промпты чаще ломаются не из-за длины, а из-за плохой структуры: обязательные правила, пожелания по стилю и формат ответа смешаны в один неиерархичный блок.

Надёжность появляется там, где есть порядок и приоритеты.

## Базовый порядок слоёв

Практичный instruction stack строится так:

1. **Роль и цель**
2. **Жёсткие ограничения** (compliance, legal, безопасность)
3. **Требования к процессу**
4. **Контракт выхода** (явная структура ответа)
5. **Стиль и тон**

Если стиль стоит выше ограничений, риск ошибок растёт мгновенно.

## System и User: кто за что отвечает

- **System-уровень**: стабильные правила и неизменные политики.
- **User-уровень**: переменные данные и детали конкретного запроса.

Так меньше шансов случайно перезаписать критичные ограничения.

## Обязательная строка про конфликт

Добавляйте явное правило поведения:

> Если инструкции конфликтуют или не хватает обязательных данных, остановись, объясни конфликт и запроси уточнение.

Без этого модель часто выбирает «уверенное додумывание».

## Частые антипаттерны

- «суп из инструкций» в одном абзаце;
- критичные требования спрятаны в тексте;
- «постарайся» вместо «обязательно»;
- не задан чёткий формат выхода.

Итог главы:

**Промпт без иерархии — это политика без управления.**

---

[Стек инструкций для ИИ](../ai_about_ai_ru/03_prompt_engineering_instruction_stacks.md) | [Instruction Stacks](../ai_about_ai_short/03_prompt_engineering_instruction_stacks.md) |
